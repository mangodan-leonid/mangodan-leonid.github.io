import{j as he,u as Re,a as me,i as ye,b as be,d as Se,e as Ce,f as Ve,g as xe,h as we}from"./useChartManager-BKz800T7.js";import{g as Z,p as ee,d as v,h as te,b5 as L,c as j,b2 as _e,r as R,o as ae,b4 as re,a3 as ke,y as Le,A as G,a4 as A,a5 as P,W as h,ak as K,X as y,al as W,a6 as w,av as p,a9 as Y,ad as k,aS as De}from"./index-Bdx9uudd.js";import{l as se,m as oe,k as J,V as Ee,T as $e}from"./VBtn-DRW3YHfC.js";import{V as Ne,a as Ae,b as Pe}from"./WorldMapLayout-y6O5jjj5.js";const ne=L.reduce((e,o)=>(e[o]={type:[Boolean,String,Number],default:!1},e),{}),le=L.reduce((e,o)=>{const a="offset"+j(o);return e[a]={type:[String,Number],default:null},e},{}),ie=L.reduce((e,o)=>{const a="order"+j(o);return e[a]={type:[String,Number],default:null},e},{}),X={col:Object.keys(ne),offset:Object.keys(le),order:Object.keys(ie)};function Te(e,o,a){let n=e;if(!(a==null||a===!1)){if(o){const l=o.replace(e,"");n+=`-${l}`}return e==="col"&&(n="v-"+n),e==="col"&&(a===""||a===!0)||(n+=`-${a}`),n.toLowerCase()}}const je=["auto","start","end","center","baseline","stretch"],Oe=ee({cols:{type:[Boolean,String,Number],default:!1},...ne,offset:{type:[String,Number],default:null},...le,order:{type:[String,Number],default:null},...ie,alignSelf:{type:String,default:null,validator:e=>je.includes(e)},...oe(),...se()},"VCol"),q=Z()({name:"VCol",props:Oe(),setup(e,o){let{slots:a}=o;const n=v(()=>{const l=[];let u;for(u in X)X[u].forEach(d=>{const g=e[d],m=Te(u,d,g);m&&l.push(m)});const c=l.some(d=>d.startsWith("v-col-"));return l.push({"v-col":!c||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),l});return()=>te(e.tag,{class:[n.value,e.class],style:e.style},a.default?.())}}),O=["start","end","center"],ue=["space-between","space-around","space-evenly"];function F(e,o){return L.reduce((a,n)=>{const l=e+j(n);return a[l]=o(),a},{})}const Fe=[...O,"baseline","stretch"],ce=e=>Fe.includes(e),ve=F("align",()=>({type:String,default:null,validator:ce})),ze=[...O,...ue],de=e=>ze.includes(e),fe=F("justify",()=>({type:String,default:null,validator:de})),Me=[...O,...ue,"stretch"],pe=e=>Me.includes(e),ge=F("alignContent",()=>({type:String,default:null,validator:pe})),Q={align:Object.keys(ve),justify:Object.keys(fe),alignContent:Object.keys(ge)},Ie={align:"align",justify:"justify",alignContent:"align-content"};function Ue(e,o,a){let n=Ie[e];if(a!=null){if(o){const l=o.replace(e,"");n+=`-${l}`}return n+=`-${a}`,n.toLowerCase()}}const Be=ee({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:ce},...ve,justify:{type:String,default:null,validator:de},...fe,alignContent:{type:String,default:null,validator:pe},...ge,...oe(),...se()},"VRow"),He=Z()({name:"VRow",props:Be(),setup(e,o){let{slots:a}=o;const n=v(()=>{const l=[];let u;for(u in Q)Q[u].forEach(c=>{const d=e[c],g=Ue(u,c,d);g&&l.push(g)});return l.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),l});return()=>te(e.tag,{class:["v-row",n.value,e.class],style:e.style},a.default?.())}}),T=()=>({animation:!1,progressive:1e3,progressiveThreshold:3e3,progressiveChunkMode:"mod",notMerge:!1,lazyUpdate:!0,silent:!1,blendMode:"source-over",tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1},backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"transparent",textStyle:{color:"#fff",fontSize:12}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#e0e0e0"}},axisTick:{show:!1},axisLabel:{color:"#666",fontSize:11}},yAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666",fontSize:11},splitLine:{lineStyle:{color:"#f0f0f0",type:"dashed"}}}}),Ge=()=>({...T(),title:{text:"연준 역레포 (RRP)",left:"center",textStyle:{fontSize:16,fontWeight:"bold",color:"#333"}},yAxis:{...T().yAxis,axisLabel:{...T().yAxis.axisLabel,formatter:e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toFixed(0)}},series:[{type:"line",smooth:!0,symbol:"none",lineStyle:{width:2,color:"#4caf50"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(76, 175, 80, 0.3)"},{offset:1,color:"rgba(76, 175, 80, 0.05)"}]}}}]}),Ke=_e("reverseRepo",()=>{const e=R(null),o=R(null),a=R(!1),n=R(null),l=R(null),u=R("2025-07-01"),c=v(()=>{if(!e.value||!e.value.observations?.length)return null;const t=e.value.observations[e.value.observations.length-1];return t.value!=="."?parseFloat(t.value):null}),d=v(()=>{if(!e.value||!e.value.observations?.length)return null;const t=e.value.observations;if(t.length<2)return null;const s=t[t.length-2];return s.value!=="."?parseFloat(s.value):null}),g=v(()=>{const t=c.value,s=d.value;return t===null||s===null?null:t-s}),m=v(()=>{const t=c.value,s=d.value;return t===null||s===null?null:(t-s)/s*100}),C=v(()=>{const t=c.value;return t?t<5e3?"low":t<1e4?"normal":"high":"unknown"}),V=v(()=>{switch(C.value){case"low":return"낮음 (유동성 풍부)";case"normal":return"보통";case"high":return"높음 (유동성 부족)";default:return"알 수 없음"}}),x=v(()=>{switch(C.value){case"low":return"success";case"normal":return"warning";case"high":return"error";default:return"grey"}}),b=v(()=>!o.value||!o.value.observations?[]:o.value.observations.filter(t=>t.value!==".").map(t=>({date:new Date(t.date),timestamp:new Date(t.date).getTime(),value:parseFloat(t.value),formattedValue:_(parseFloat(t.value))})).sort((t,s)=>t.timestamp-s.timestamp)),r=v(()=>b.value.map(t=>t.date.toLocaleDateString("ko-KR",{month:"short",day:"numeric"}))),f=v(()=>b.value.map(t=>t.value)),S=v(()=>{const t=f.value.filter(s=>s!==null);return t.length>0?Math.min(...t):0}),D=v(()=>{const t=f.value.filter(s=>s!==null);return t.length>0?Math.max(...t):0}),E=v(()=>{const t=f.value.filter(s=>s!==null);return t.length>0?t.reduce((s,i)=>s+i,0)/t.length:0}),_=t=>t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toFixed(0);return{reverseRepoData:e,reverseRepoHistoryData:o,loading:a,error:n,lastUpdated:l,observationStart:u,currentReverseRepo:c,previousReverseRepo:d,reverseRepoChange:g,reverseRepoChangePercent:m,reverseRepoStatus:C,reverseRepoStatusText:V,reverseRepoStatusColor:x,chartData:b,chartLabels:r,chartValues:f,minValue:S,maxValue:D,averageValue:E,formatValue:_,setReverseRepoData:t=>{e.value=t,l.value=new Date,n.value=null},setReverseRepoHistoryData:t=>{o.value=t,l.value=new Date,n.value=null},setObservationStart:t=>{u.value=t},setLoading:t=>{a.value=t},setError:t=>{n.value=t,a.value=!1},clearError:()=>{n.value=null},reset:()=>{e.value=null,o.value=null,a.value=!1,n.value=null,l.value=null}}});function We(){const e=Ke(),o=he(void 0),a=R(null),n=R(!1),l=R(3e5),u=async()=>{try{e.setLoading(!0),e.clearError();const r=await o.get("/series/observations",{params:{series_id:"RRPONTSYD",api_key:void 0,file_type:"json",observation_start:e.observationStart,sort_order:"desc",limit:1}});if(r.data&&r.data.observations)e.setReverseRepoData(r.data),console.log("역레포 데이터 업데이트 완료:",r.data);else throw new Error("역레포 데이터 형식이 올바르지 않습니다.")}catch(r){console.error("역레포 데이터 가져오기 실패:",r),e.setError(r.message||"역레포 데이터를 가져오는데 실패했습니다.")}finally{e.setLoading(!1)}},c=async(r=null)=>{try{e.setLoading(!0),e.clearError();const f=r||e.observationStart,S=await o.get("/series/observations",{params:{series_id:"RRPONTSYD",api_key:void 0,file_type:"json",observation_start:f,sort_order:"asc"}});if(S.data&&S.data.observations)return e.setReverseRepoHistoryData(S.data),console.log("역레포 히스토리 데이터 업데이트 완료:",S.data),S.data;throw new Error("역레포 히스토리 데이터 형식이 올바르지 않습니다.")}catch(f){return console.error("역레포 히스토리 데이터 가져오기 실패:",f),e.setError(f.message||"역레포 히스토리 데이터를 가져오는데 실패했습니다."),null}finally{e.setLoading(!1)}},d=async r=>{e.setObservationStart(r),await c(r)},g=()=>{a.value||(n.value=!0,a.value=setInterval(()=>{u()},l.value),console.log(`역레포 자동 새로고침 시작 (${l.value/1e3}초 간격)`))},m=()=>{a.value&&(clearInterval(a.value),a.value=null,n.value=!1,console.log("역레포 자동 새로고침 중지"))},C=r=>{l.value=r,n.value&&(m(),g())};ae(()=>{u(),c(),g()}),re(()=>{m()});const V=r=>r==null?"N/A":e.formatValue(r),x=r=>r==null?"N/A":`${r>=0?"+":""}${e.formatValue(Math.abs(r))}`,b=r=>r==null?"N/A":`${r>=0?"+":""}${r.toFixed(2)}%`;return{reverseRepoData:e.reverseRepoData,reverseRepoHistoryData:e.reverseRepoHistoryData,loading:e.loading,error:e.error,lastUpdated:e.lastUpdated,observationStart:e.observationStart,currentReverseRepo:e.currentReverseRepo,previousReverseRepo:e.previousReverseRepo,reverseRepoChange:e.reverseRepoChange,reverseRepoChangePercent:e.reverseRepoChangePercent,reverseRepoStatus:e.reverseRepoStatus,reverseRepoStatusText:e.reverseRepoStatusText,reverseRepoStatusColor:e.reverseRepoStatusColor,chartData:e.chartData,chartLabels:e.chartLabels,chartValues:e.chartValues,minValue:e.minValue,maxValue:e.maxValue,averageValue:e.averageValue,autoRefreshEnabled:n,refreshInterval:l,fetchReverseRepoData:u,fetchReverseRepoHistory:c,updateObservationStart:d,startAutoRefresh:g,stopAutoRefresh:m,setRefreshInterval:C,formatReverseRepoValue:V,formatReverseRepoChange:x,formatReverseRepoChangePercent:b,clearError:e.clearError,reset:e.reset}}const Ye={class:"reverse-repo-chart-container"},Je={class:"chart-header"},Xe={class:"chart-title"},qe={class:"chart-controls"},Qe={key:0,class:"current-info"},Ze={class:"info-card"},et={class:"status-card"},tt={class:"date-controls"},at={class:"chart-wrapper"},rt={key:1,class:"loading-overlay"},st={__name:"ReverseRepoChart",setup(e){Re([be,Se,Ce,Ve,xe,we]);const o=R(null),a=R(null),n=me(),{currentReverseRepo:l,reverseRepoChange:u,reverseRepoChangePercent:c,reverseRepoStatusText:d,reverseRepoStatusColor:g,chartData:m,chartLabels:C,chartValues:V,loading:x,observationStart:b,fetchReverseRepoHistory:r,updateObservationStart:f,formatReverseRepoValue:S,formatReverseRepoChange:D,formatReverseRepoChangePercent:E}=We(),_=[{title:"최근 30일",value:30},{title:"최근 60일",value:60},{title:"최근 90일",value:90},{title:"최근 180일",value:180},{title:"최근 1년",value:365}],$=R(90),z=s=>{const i=new Date;return i.setDate(i.getDate()-s),i.toISOString().split("T")[0]},M=s=>{const i=z(s);f(i)},I=s=>{s&&f(s)},U=async()=>{if(o.value)try{a.value=ye(o.value,null,{renderer:"canvas",useDirtyRect:!0}),n.registerChart("reverseRepo",a.value),window.addEventListener("resize",t),await r()}catch(s){console.error("역레포 차트 초기화 실패:",s)}},B=()=>{if(!a.value||!m.value.length)return;const s=Ge(),i={...s,xAxis:{...s.xAxis,data:C.value},series:[{...s.series[0],data:V.value}]};a.value.setOption(i,!0)},H=async()=>{await r()},t=()=>{a.value&&a.value.resize()};return Le([m,C,V],()=>{G(()=>{B()})},{deep:!0}),ae(()=>{G(()=>{U()})}),re(()=>{a.value&&n.unregisterChart("reverseRepo"),window.removeEventListener("resize",t)}),(s,i)=>(P(),A("div",Ye,[h("div",Je,[h("div",Xe,[y(J,{icon:"mdi-bank",class:"me-2"}),i[2]||(i[2]=W(" 연준 역레포 (RRP) ",-1))]),h("div",qe,[y(Ee,{variant:"text",size:"small",onClick:H,loading:p(x)},{default:w(()=>[y(J,{icon:"mdi-refresh"})]),_:1},8,["loading"])])]),p(l)!==null?(P(),A("div",Qe,[h("div",Ze,[i[3]||(i[3]=h("div",{class:"info-label"},"현재 역레포",-1)),h("div",{class:Y(["info-value",p(g)])},k(p(S)(p(l))),3),h("div",{class:Y(["info-change",p(u)>=0?"positive":"negative"])},k(p(D)(p(u)))+" ("+k(p(E)(p(c)))+") ",3)]),h("div",et,[i[4]||(i[4]=h("div",{class:"status-label"},"유동성 상태",-1)),y(Ne,{color:p(g),size:"small",variant:"flat"},{default:w(()=>[W(k(p(d)),1)]),_:1},8,["color"])])])):K("",!0),h("div",tt,[y(He,null,{default:w(()=>[y(q,{cols:"12",md:"6"},{default:w(()=>[y(Ae,{modelValue:p(b),"onUpdate:modelValue":[i[0]||(i[0]=N=>De(b)?b.value=N:null),I],label:"관찰 시작일",type:"date",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),y(q,{cols:"12",md:"6"},{default:w(()=>[y(Pe,{modelValue:$.value,"onUpdate:modelValue":[i[1]||(i[1]=N=>$.value=N),M],items:_,label:"기간 선택",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),h("div",at,[h("div",{ref_key:"chartRef",ref:o,class:"chart",style:{height:"400px"}},null,512)]),p(x)?(P(),A("div",rt,[y($e,{indeterminate:"",color:"primary",size:"48"})])):K("",!0)]))}},ut=ke(st,[["__scopeId","data-v-29cf65b4"]]);export{ut as default};
